# 架构决策（Architectural Decision-Making）

## 一、学习目标

完成本课后，学习者应能够：
1. 理解架构决策在技术领导力和项目成功中的作用。
2. 掌握架构决策的分析方法和评估标准。
3. 能够在团队中制定可行的技术方案和决策记录。
4. 具备平衡性能、可扩展性、成本和风险的能力。

---

## 二、核心概念

架构决策是选择系统设计方案和技术栈的过程，直接影响系统的性能、可维护性和可扩展性。

### 核心概念

1. **架构决策的目标**
    - 确保系统满足业务需求和非功能性需求（性能、可扩展性、安全性）
    - 降低技术债务和未来维护成本
    - 提供团队统一的设计指导

2. **决策驱动因素**
    - **功能需求**：系统必须实现的核心功能
    - **非功能需求**：性能、可扩展性、可靠性、安全性
    - **技术约束**：现有平台、团队技能、预算
    - **风险与不确定性**：新技术、外部依赖、时间限制

3. **架构决策流程**
    1. 明确问题和目标
    2. 收集候选方案
    3. 评估方案优缺点
    4. 选择最优方案并记录决策
    5. 持续跟踪和调整

4. **架构决策记录（ADR, Architectural Decision Record）**
    - 记录决策背景、备选方案、决策理由、结果和影响
    - 保持团队共享和历史追踪

---

## 三、实操方法

1. **定义决策问题**
    - 确认业务目标和系统需求
    - 明确需要做出决策的架构点

2. **收集备选方案**
    - 调研技术选型、设计模式、框架和工具
    - 考虑团队技能和技术债务

3. **评估方案**
    - 使用权重矩阵评估：性能、成本、可维护性、风险
    - 讨论技术优缺点和长期影响

4. **做出决策并记录**
    - 在团队会议达成共识
    - 创建 ADR 文档，记录决策理由和影响

5. **实施与反馈**
    - 执行选定方案
    - 收集实施反馈，必要时迭代架构决策

---

## 四、案例分析

**案例：微服务架构选型**

- 决策问题：选择单体应用还是微服务架构
- 备选方案：
    1. 单体应用：部署简单、开发快速
    2. 微服务：可扩展、团队分工清晰
- 评估标准：性能、开发速度、可维护性、团队能力
- 决策：采用微服务架构，但初期保留部分单体模块降低风险
- ADR 文档：记录选型原因、权衡点、长期扩展计划

---

## 五、常见问题与误区

1. **忽视非功能性需求**：导致系统后期性能或可维护性问题
2. **只关注技术新潮**：忽略团队能力和成本约束
3. **决策未记录**：团队成员难以理解历史决策理由
4. **决策孤立进行**：未与业务需求和项目计划对齐

---

## 六、练习与作业

1. 针对你的项目，列出三个关键架构决策点。
2. 收集至少两种备选方案并评估优缺点。
3. 使用 ADR 模板记录决策及理由。
4. 模拟团队会议讨论决策，达成共识并更新文档。

---

## 七、扩展阅读

- 《Documenting Architecture Decisions》— Michael Nygard
- 《软件架构模式与最佳实践》
- 在线工具：ADR GitHub 模板、Confluence